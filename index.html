<!DOCTYPE html>

<html lang="ru">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>

  

  <style>


.search-sort-row {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
  width: 100%;
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}
.search-sort-row input,
.search-sort-row select,
.search-sort-row .other-site-btn {
  flex: 1 1 0;
  width: 100%;
  max-width: none;
  box-sizing: border-box;
  margin: 10px auto; /* добавьте эту строку */
}
.other-site-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  background: #007bff;
  color: #fff !important;
  text-align: center;
  padding: 10px 0;
  border-radius: 5px;
  text-decoration: none;
  transition: background 0.2s;
  font-weight: bold;
  height: 100%;
}
.other-site-btn:hover {
  background: #0056b3;
}
@media (max-width: 600px) {
  .search-sort-row {
    flex-direction: column;
    gap: 0;
    max-width: 100%;
  }
  .other-site-btn {
    margin-top: 8px;
  }
}


/* ...existing code... */
th:nth-child(5), td:nth-child(5) {
  min-width: 90px;
  width: 80px;
}
/* ...existing code... */


    /* ...existing code... */
thead th {
  position: sticky;
  top: 0;
  background: #00fff7;
  z-index: 2;
}
/* ...existing code... */


body.modal-open {
  overflow: hidden;           /* Запретить прокрутку */
  pointer-events: none;       /* Запретить клики по всему body */
}
#previewBlock {
  pointer-events: auto !important; /* Разрешить клики по модальному окну */
}

 button.delete-item {
  background: none; /* Убираем фон */
  border: none; /* Убираем границу */
  color: #dc3545; /* Красный цвет для кнопки */
  font-size: 14px; /* Размер текста */
  cursor: pointer; /* Указываем, что это кнопка */
  padding: 0; /* Убираем лишние внутренние отступы */
  width: 20px; /* Устанавливаем фиксированную ширину */
  height: 20px; /* Устанавливаем фиксированную высоту */
  border-radius: 20%; /* Делаем кнопку круглой */
  line-height: 1; /* Убираем лишние отступы внутри кнопки */
  display: flex; /* Центрируем содержимое */
  align-items: center;
  justify-content: center;
}

button.delete-item:hover {
  color: #c82333; /* Более тёмный красный при наведении */
}

    body {

  background-image: url('фон.avif'); /* сюда вставь ссылку или путь к картинке */

  background-size: cover;

  background-repeat: no-repeat;

  background-position: center center;

}



    * { box-sizing: border-box; margin: 0; padding: 0; }

    body { font-family: 'Arial', sans-serif; background: #f4f4f4; color: #333; }

    h1, h2 { text-align: center; margin-bottom: 20px; animation: fadeIn 1s ease forwards; }

    body {

  background-image: url('фон.avif'); /* сюда вставь ссылку или путь к картинке */

  background-size: cover;

  background-repeat: no-repeat;

  background-position: center center;

}

h1 {

  color: rgb(255, 255, 255);

}





    input, select, button, textarea {

      font-size: 1rem;

      padding: 10px;

      margin: 10px auto;

      width: 100%;

      max-width: 400px;

      display: block;

      border-radius: 5px;

      border: 1px solid #ccc;

    }

    .cart-item {

  display: flex;

  align-items: center;

  justify-content: space-between;

  margin-bottom: 10px;

}



    button {

      background: #28a745;

      color: white;

      border: none;

      cursor: pointer;

      transition: 0.3s;

    }

    button:hover { background: #218838; }



    table {

      width: 100%;

      border-collapse: collapse;

      margin-bottom: 20px;

      background: white;

      box-shadow: 0 0 10px #ccc;

    }

    th, td {

      padding: 10px;

      border: 1px solid #ddd;

      text-align: center;

    }

    th { background: #f8f8f8; }



    .product-img { max-width: 60px; height: auto; transition: transform 0.3s ease; }

    .product-img:hover { transform: scale(1.1); }



    .cart-summary { text-align: center; font-weight: bold; margin: 10px 0; }

    .order-form, #orderHistory { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px #ccc; margin-top: 20px; }



    .delete-order {

      background: #dc3545;

      color: white;

      border: none;

      padding: 8px 12px;

      margin-top: 10px;

      border-radius: 5px;

      cursor: pointer;

      transition: background 0.3s ease;

    }

    .delete-order:hover {

      background: #c82333;

    }



    @keyframes fadeIn {

      from { opacity: 0; transform: translateY(20px); }

      to { opacity: 1; transform: translateY(0); }

    }



    /* Новая анимация для добавления в корзину */

    @keyframes addToCart {

      0% { transform: scale(1); background-color: #28a745; }

      50% { transform: scale(1.2); background-color: #218838; }

      100% { transform: scale(1); background-color: #28a745; }

    }

    .animate-add {

      animation: addToCart 0.5s ease;

    }



    @media (max-width: 600px) {

      th, td { font-size: 12px; padding: 6px; }

      input, select, button, textarea { font-size: 0.9rem; padding: 8px; }

      .cart-summary { font-size: 1.2rem; }

      #cartList div { font-size: 0.9rem; }

      .order-form input, .order-form button { width: 90%; }

    }
    @media (max-width: 600px) {
  button.delete-item {
    width: 20px; /* Устанавливаем фиксированную ширину */
    height: 20px; /* Устанавливаем фиксированную высоту */
    font-size: 12px; /* Уменьшаем размер текста */
    padding: 0; /* Убираем лишние отступы */
  }
}

    @media (max-width: 600px) {
  th, td { font-size: 12px; padding: 6px; }
  input, select, button, textarea { font-size: 0.9rem; padding: 8px; }
  .cart-summary { font-size: 1.2rem; }
  #cartList div { font-size: 0.9rem; }
  .order-form input, .order-form button { width: 90%; }
  button.delete-item {
    width: 20px;
    height: 20px;
    font-size: 12px;
    padding: 0;
  }
}

  </style>
      



  <!-- SweetAlert2 -->

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>

  <!-- Блок для просмотра фото -->
  <div id="previewBlock" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:1000; pointer-events:auto;">
    <div id="previewInner" style="position:absolute; top:10%; left:50%; transform:translateX(-50%); background:white; padding:20px; border-radius:10px; box-shadow:0 0 20px #0008;">
      <span id="closePreview" style="cursor:pointer; float:right; font-size:24px;">&times;</span>
      <img id="previewImg" src="" alt="Просмотр" style="max-width:90vw; max-height:70vh; display:block; margin:auto;">
    </div>
  </div>
<!-- filepath: c:\Users\hp\Desktop\нож\index.html -->

  <h1>Мелочь - Каталог товаров</h1>



  <div class="search-sort-row">
    <input type="text" id="search" placeholder="Поиск товара..." />
    <select id="sort">
      <option value="">Сортировка по цене</option>
      <option value="asc">Сначала дешёвые</option>
      <option value="desc">Сначала дорогие</option>
    </select>
    <a href=" https://kara-ssyy-oomat.github.io/scoch/" target="_blank" class="other-site-btn">Другой сайт для скотч</a>

    <a href="https://kara-ssyy-oomat.github.io/noj/" target="_blank" class="other-site-btn">Другой сайт для нож</a>
  </div>



  <table>

    <thead>
      <tr>
        <th>№</th>
        <th>Фото</th>
        <th>Название</th>
        <th>Цена</th>
        <th>Кол-во</th>
        <th>Добавить</th>
        <th id="managementHeader" style="display: none;">Управление</th>
      </tr>
    </thead>

    <tbody id="productTable"></tbody>

  </table>



  <div class="order-form">

    <h2>Оформить заказ</h2>

    <div id="cartList"></div>

    <div class="cart-summary">Итого: <span id="totalSum">0</span> с</div>

    <button id="clearCart">Очистить корзину</button>

    <input type="text" id="name" placeholder="Ваше имя" required />

    <input type="tel" id="phone" placeholder="Телефон" required />

    <input type="text" id="address" placeholder="Адрес доставки" required />

    <button id="submitOrder">Отправить заказ</button>

  </div>

  <button id="logoutUser" style="margin:10px 0;">Выйти из профиля</button>

  <button id="toggleHistory">История заказов</button>

  <div id="orderHistory" style="display:none">

    <h2>История заказов</h2>

    <ul id="historyList"></ul>

  </div>

  <div id="adminAuth" style="margin:20px 0;">
    <h3>Вход для администратора</h3>
    <input type="password" id="adminPassword" placeholder="Пароль администратора">
    <button id="loginAdmin">Войти</button>
  </div>

  <div id="adminAddProduct" style="margin:20px 0; display: none;">
    <h3>Добавить товар (только для администратора)</h3>
    <input type="text" id="newTitle" placeholder="Название товара">
    <input type="number" id="newPrice" placeholder="Цена">
    <input type="number" id="newOptPrice" placeholder="Оптовая цена">
    <input type="number" id="newOptQty" placeholder="Минимальное количество для опта">
    <input type="number" id="newMinQty" placeholder="Минимальное количество для покупки">
    <input type="text" id="newImage" placeholder="URL изображения">
    <button id="addProductBtn">Добавить товар</button>
  </div>



  <script>
 let products = [];
 let isAdmin = false;

// Инициализация Firebase
const firebaseConfig = {
  apiKey: "AIzaSyByQyTeCdef7EFbkgrzDK7cXI6abAGf0jw",
  authDomain: "my-shop-b5192.firebaseapp.com",
  projectId: "my-shop-b5192",
  storageBucket: "my-shop-b5192.appspot.com",
  messagingSenderId: "433705424979",
  appId: "1:433705424979:web:a5763f58da7ca2777e8ea6",
  measurementId: "G-WYPCDVCWST"
};

// Проверка инициализации Firebase
try {
  firebase.initializeApp(firebaseConfig);
  console.log('Firebase initialized successfully');
} catch (error) {
  console.error('Firebase initialization error:', error);
}

const db = firebase.firestore();
const storage = firebase.storage();

// Пароль администратора
const ADMIN_PASSWORD = "009860";

// Загрузка товаров
async function loadProducts() {
  try {
    console.log('Loading products...');
    const snapshot = await db.collection('products').orderBy('order').get();
    products = [];
    snapshot.forEach(doc => {
      products.push({ id: doc.id, ...doc.data() });
    });
    console.log('Products loaded:', products.length);
    renderProducts();
  } catch (error) {
    console.error('Error loading products:', error);
    Swal.fire('Ошибка', 'Не удалось загрузить товары', 'error');
  }
}

// Обработчик входа администратора
document.getElementById('loginAdmin').addEventListener('click', function() {
  const password = document.getElementById('adminPassword').value;
  console.log('Login attempt with password:', password);
  
  if (password === ADMIN_PASSWORD) {
    isAdmin = true;
    document.getElementById('adminAddProduct').style.display = 'block';
    document.getElementById('adminAuth').style.display = 'none';
    document.getElementById('managementHeader').style.display = 'table-cell';
    Swal.fire('Успех!', 'Вы вошли как администратор', 'success');
    renderProducts();
  } else {
    Swal.fire('Ошибка', 'Неверный пароль', 'error');
  }
});

// Функция отображения товаров
function renderProducts() {
  console.log('Rendering products, admin status:', isAdmin);
  let filtered = products.filter(p => p.title?.trim() && p.image?.trim());

  if (search.value) {
    filtered = filtered.filter(p => p.title.toLowerCase().includes(search.value.toLowerCase()));
  }

  if (sort.value) {
    filtered.sort((a, b) => sort.value === 'asc' ? a.price - b.price : b.price - a.price);
  }

  productTable.innerHTML = '';

  filtered.forEach((p, idx) => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${idx + 1}</td>
      <td><img src="${p.image}" class="product-img" alt="${p.title}" style="cursor:pointer;" onclick="showPreview('${p.image}')"/></td>
      <td>
        ${(() => {
          const matches = p.title.match(/\(.*?\)/g);
          if (matches && matches.length) {
            const lastBracket = matches[matches.length - 1];
            const main = p.title.replace(lastBracket, '').trim();
            return `
              ${main}
              <div style="font-size:12px;color:#888;">${lastBracket}</div>
            `;
          } else {
            return p.title;
          }
        })()}
      </td>
      <td class="price-cell">
        <span>${p.price}c</span>
      </td>
      <td>
        <input type="number" min="${p.minQty || 1}" value="${p.minQty || 1}" 
          oninput="updatePriceInRow(this, ${p.price}, ${p.optPrice || p.price}, ${p.optQty || 0})" />
      </td>
      <td><button onclick="addToCart('${p.id}', '${p.title}', ${p.price}, '${p.image}', this)">добавить</button></td>
      ${isAdmin ? `
        <td>
          <button onclick="deleteProduct('${p.id}')" style="background: #dc3545; margin-right: 5px;">Удалить</button>
          <button onclick="moveProduct('${p.id}', 'up')" ${idx === 0 ? 'disabled' : ''}>↑</button>
          <button onclick="moveProduct('${p.id}', 'down')" ${idx === filtered.length - 1 ? 'disabled' : ''}>↓</button>
        </td>
      ` : ''}
    `;
    productTable.appendChild(row);
  });
}

// Загрузка товаров при старте
document.addEventListener('DOMContentLoaded', function() {
  console.log('DOM loaded, initializing...');
  loadProducts();
});

const cart = JSON.parse(localStorage.getItem('cart')) || [];

const productTable = document.getElementById('productTable');
const search = document.getElementById('search');
const sort = document.getElementById('sort');
const cartList = document.getElementById('cartList');
const totalSum = document.getElementById('totalSum');

// Автозаполнение данных пользователя из localStorage
const userData = JSON.parse(localStorage.getItem('userData') || '{}');
if (userData.name) document.getElementById('name').value = userData.name;
if (userData.phone) document.getElementById('phone').value = userData.phone;
if (userData.address) document.getElementById('address').value = userData.address;

function addToCart(id, title, price, image, btn) {
  const row = btn.parentElement.parentElement;
  const qtyInput = row.querySelector('input');
  const qty = +qtyInput.value;

  const product = products.find(p => p.id === id);

  if (qty < (product.minQty || 1)) {
    Swal.fire('Ошибка', `Минимальное количество для покупки: ${product.minQty || 1}`, 'warning');
    qtyInput.value = product.minQty || 1;
    return;
  }

  // Считаем итоговое количество этого товара в корзине
  const index = cart.findIndex(item => item.id === id);
  let totalQty = qty;
  if (index !== -1) totalQty += cart[index].qty;

  // Определяем цену: если опт, то оптовая цена
  let finalPrice = price;
  if (product.optQty && totalQty >= product.optQty) {
    finalPrice = product.optPrice;
  }

  // Добавление или обновление в корзине
  if (index !== -1) {
    cart[index].qty += qty;
    cart[index].price = finalPrice; // обновляем цену, если стало оптом
  } else {
    cart.push({ id, title, price: finalPrice, qty });
  }

  updateCart();

  btn.classList.add('animate-add');
  setTimeout(() => btn.classList.remove('animate-add'), 500);

  Swal.fire({
    title: 'Товар добавлен в корзину!',
    text: `${title} × ${qty} был добавлен в вашу корзину.`,
    icon: 'success',
    confirmButtonText: 'Ок',
    position: 'bottom',
    showConfirmButton: true,
    timer: 1500,
    padding: '10px',
    toast: true
  });

  localStorage.setItem('cart', JSON.stringify(cart));
}

function updateCart() {
  cartList.innerHTML = '';

  let total = 0;

  cart.forEach((item, i) => {
    total += item.qty * item.price;

    const div = document.createElement('div');
    div.classList.add('cart-item');
    div.innerHTML = `
  <span style="flex-grow:1;">${item.title} — ${item.qty} × ${item.price}c = ${item.qty * item.price}c</span>
  <button class="delete-item" onclick="removeFromCart(${i})">&times;</button>
`;

    cartList.appendChild(div);
  });

  totalSum.textContent = total;

  // Проверка на пустоту корзины
  const clearCartButton = document.getElementById('clearCart');
  if (cart.length === 0) {
    clearCartButton.style.display = 'none'; // скрыть кнопку, если корзина пуста
  } else {
    clearCartButton.style.display = 'block'; // показать кнопку, если корзина не пуста
  }

  // Сохраняем корзину в localStorage
  localStorage.setItem('cart', JSON.stringify(cart));
}

function removeFromCart(i) {
  cart.splice(i, 1);
  updateCart();
}

document.getElementById('submitOrder').onclick = () => {
  const name = document.getElementById('name').value.trim();
  const phone = document.getElementById('phone').value.trim();
  const address = document.getElementById('address').value.trim();
  if (!name || !phone || !address || cart.length === 0) {
    Swal.fire('Ошибка', 'Заполните все поля и добавьте товары', 'warning');
    return;
  }

  const items = cart.map(i => `${i.title} — ${i.qty}×${i.price}c=${i.qty * i.price}`).join('\n');
  const total = cart.reduce((sum, item) => sum + item.qty * item.price, 0);

  const msg = `Новый заказ:
Имя: ${name}
Телефон: ${phone}
Адрес: ${address}
Товары:
${items}

Итого: ${total}c`;
  
  fetch('https://api.telegram.org/bot7960727448:AAF0B2mizrzj7sjHP68n-1IcjLoNc6kwVkE/sendMessage', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ chat_id: '5567924440', text: msg })
  }).then(r => {
    if (r.ok) {
      Swal.fire('Успех!', 'Ваш заказ отправлен!', 'success');
      cart.length = 0;
      updateCart();
      localStorage.removeItem('cart');
      localStorage.setItem('userData', JSON.stringify({
    name,
    phone,
    address
  }));
      document.getElementById('name').value = '';
      document.getElementById('phone').value = '';
      document.getElementById('address').value = '';
    } else {
      Swal.fire('Ошибка', 'Не удалось отправить заказ. Попробуйте позже.', 'error');
    }
  }).catch(error => {
    console.error(error);
    Swal.fire('Ошибка', 'Не удалось отправить заказ. Проверьте подключение к интернету.', 'error');
  });
};

document.getElementById('clearCart').onclick = () => {
  cart.length = 0; // очищаем массив корзины
  updateCart();    // обновляем отображение
  localStorage.removeItem('cart'); // убираем данные из localStorage
  Swal.fire('Корзина очищена!', '', 'success'); // показываем уведомление
};

function deleteOrder(index) {
  let history = JSON.parse(localStorage.getItem('orderHistory') || '[]');
  history.splice(index, 1);
  localStorage.setItem('orderHistory', JSON.stringify(history));
  document.getElementById('toggleHistory').click();
  document.getElementById('toggleHistory').click();
}

document.getElementById('toggleHistory').onclick = () => {
  const hist = document.getElementById('orderHistory');
  hist.style.display = hist.style.display === 'none' ? 'block' : 'none';

  const history = JSON.parse(localStorage.getItem('orderHistory') || '[]');
  const list = document.getElementById('historyList');
  list.innerHTML = '';

  if (history.length === 0) {
    list.innerHTML = '<li>История заказов пуста.</li>';
    document.getElementById('toggleHistory').style.display = 'none'; // Скрыть кнопку, если нет заказов
    return;
  }
  
  history.forEach((o, index) => {
    const li = document.createElement('li');
    const itemsText = o.items.map(i => `${i.title} × ${i.qty}`).join(', ');
    li.innerHTML = `
      <strong>Заказ от: ${o.time}</strong>
      <p>Имя: ${o.name}</p>
      <p>Телефон: ${o.phone}</p>
      <p>Адрес: ${o.address}</p>
      <p>Товары: ${itemsText}</p>
      <p><strong>Итого: ${o.total}c</strong></p>
      <button class="delete-order" onclick="deleteOrder(${index})">Удалить</button>
    `;
    list.appendChild(li);
  });

  // Показать кнопку только если есть заказы
  document.getElementById('toggleHistory').style.display = history.length === 0 ? 'none' : 'block';
};

search.oninput = renderProducts;
sort.onchange = renderProducts;
renderProducts();
updateCart();

function showPreview(src) {
  document.getElementById('previewImg').src = src;
  document.getElementById('previewBlock').style.display = 'block';
  document.body.classList.add('modal-open');
}

document.getElementById('closePreview').onclick = function() {
  document.getElementById('previewBlock').style.display = 'none';
  document.body.classList.remove('modal-open');
};

document.getElementById('previewBlock').onclick = function(e) {
  if (e.target === this) {
    this.style.display = 'none';
    document.body.classList.remove('modal-open');
  }
};

function updatePriceInRow(input, price, optPrice, optQty) {
  const qty = +input.value;
  const priceCell = input.parentElement.parentElement.querySelector('.price-cell span');
  if (optQty && qty >= optQty) {
    priceCell.textContent = optPrice + 'c';
  } else {
    priceCell.textContent = price + 'c';
  }
}

document.getElementById('logoutUser').onclick = () => {
  isAdmin = false;
  document.getElementById('adminAddProduct').style.display = 'none';
  document.getElementById('adminAuth').style.display = 'block';
  document.getElementById('managementHeader').style.display = 'none';
  document.getElementById('adminPassword').value = '';
  localStorage.removeItem('userData');
  document.getElementById('name').value = '';
  document.getElementById('phone').value = '';
  document.getElementById('address').value = '';
  Swal.fire('Вы вышли из профиля');
  renderProducts();
};

document.getElementById('addProductBtn').onclick = async function() {
  try {
    const title = document.getElementById('newTitle').value.trim();
    const price = +document.getElementById('newPrice').value;
    const optPrice = +document.getElementById('newOptPrice').value;
    const optQty = +document.getElementById('newOptQty').value;
    const minQty = +document.getElementById('newMinQty').value;
    const image = document.getElementById('newImage').value.trim();

    console.log('Form values:', { title, price, optPrice, optQty, minQty, image });

    if (!title || !price || !image) {
      Swal.fire('Ошибка', 'Заполните обязательные поля!', 'warning');
      return;
    }

    // Найти максимальный order среди товаров
    let maxOrder = 0;
    products.forEach(p => {
      if (typeof p.order === 'number' && p.order > maxOrder) maxOrder = p.order;
    });

    console.log('Adding product to Firestore...');
    const productData = { 
      title, 
      price, 
      optPrice: optPrice || null,
      optQty: optQty || null,
      minQty: minQty || 1,
      image, 
      order: maxOrder + 1 
    };
    
    console.log('Product data:', productData);
    
    const docRef = await db.collection('products').add(productData);
    console.log('Product added with ID:', docRef.id);
    
    Swal.fire('Товар добавлен!', '', 'success');
    loadProducts();
    
    // Очистка формы
    document.getElementById('newTitle').value = '';
    document.getElementById('newPrice').value = '';
    document.getElementById('newOptPrice').value = '';
    document.getElementById('newOptQty').value = '';
    document.getElementById('newMinQty').value = '';
    document.getElementById('newImage').value = '';
    
  } catch (error) {
    console.error('Error details:', error);
    Swal.fire('Ошибка', `Не удалось добавить товар: ${error.message}`, 'error');
  }
};

async function deleteProduct(productId) {
  try {
    const result = await Swal.fire({
      title: 'Удалить товар?',
      text: "Это действие нельзя отменить!",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#dc3545',
      cancelButtonColor: '#6c757d',
      confirmButtonText: 'Да, удалить!',
      cancelButtonText: 'Отмена'
    });

    if (result.isConfirmed) {
      await db.collection('products').doc(productId).delete();
      Swal.fire('Удалено!', 'Товар был успешно удален.', 'success');
      loadProducts();
    }
  } catch (error) {
    console.error('Error deleting product:', error);
    Swal.fire('Ошибка', 'Не удалось удалить товар', 'error');
  }
}

async function moveProduct(productId, direction) {
  try {
    const product = products.find(p => p.id === productId);
    const currentIndex = products.findIndex(p => p.id === productId);
    const newIndex = direction === 'up' ? currentIndex - 1 : currentIndex + 1;

    if (newIndex < 0 || newIndex >= products.length) return;

    // Меняем местами порядок товаров
    const tempOrder = product.order;
    const otherProduct = products[newIndex];
    
    await db.collection('products').doc(productId).update({ order: otherProduct.order });
    await db.collection('products').doc(otherProduct.id).update({ order: tempOrder });

    loadProducts();
  } catch (error) {
    console.error('Error moving product:', error);
    Swal.fire('Ошибка', 'Не удалось переместить товар', 'error');
  }
}

  </script>

</body>

</html>